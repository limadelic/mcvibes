#!/bin/bash

out() {
  echo "$@" >&2
}

# Find the real location of the installed package (works for symlinks)
SCRIPT_PATH="$(realpath "$0")"
PKG_DIR="$(dirname "$SCRIPT_PATH")"
cd "$PKG_DIR" || exit 1

case "$1" in
  on)
    out "MC Vibes in the house! Let's break some code down!"
    node dist/vibes.js
    ;;
  on!)
    nohup node dist/vibes.js > /tmp/mcvibes.log 2>&1 &
    out "MC Vibes in the house! Let's break some code down!"
    ;;
  off)
    pkill -f "node.*dist/vibes.js" || true
    out "MC Vibes has left the building! Peace out!"
    ;;
  *)
    out "Usage: vibes [on|on!|off]"
    out "  on  - foreground mode"
    out "  on! - background mode"
    out "  off - stop MC Vibes"
    exit 1
    ;;
esac
